{"ast":null,"code":"var _jsxFileName = \"E:\\\\Learn\\\\FullStack\\\\client\\\\src\\\\components\\\\Auth\\\\Google_log.js\";\nimport React, { useEffect } from 'react';\nimport { GoogleLogin } from 'react-google-login';\nimport { Button, Icon } from '@material-ui/core';\nimport { gapi } from 'gapi-script';\nimport { useDispatch } from 'react-redux'; //import { useHistory } from 'react-router-dom';\n//replaced by useNavigate\n\nimport { useNavigate } from 'react-router-dom';\nimport useStyles from './styles';\nimport { AUTH } from '../../constants/actionTypes';\n\nconst Google_log = () => {\n  const classes = useStyles(); //dispatch reducers\n\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  useEffect(() => {\n    function start() {\n      gapi.client.init({\n        clientId: \"20521068448-qc63tjr0ub065rv0knnl9gr1818744t4.apps.googleusercontent.com\",\n        scope: 'email'\n      });\n    }\n\n    gapi.load('client:auth2', start);\n  }, []);\n\n  const googleSuccess = async res => {\n    console.log(\"成功\" + res);\n    const result = res === null || res === void 0 ? void 0 : res.profileObj; //创建token\n\n    const token = res === null || res === void 0 ? void 0 : res.tokenId;\n\n    try {\n      dispatch({\n        type: AUTH,\n        data: {\n          result,\n          token\n        }\n      }); //自动刷新\n\n      navigate('/');\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const googleError = error => {\n    console.log('google登录失败啦,error信息：');\n    console.log(error);\n  };\n\n  return /*#__PURE__*/React.createElement(GoogleLogin, {\n    clientId: \"20521068448-qc63tjr0ub065rv0knnl9gr1818744t4.apps.googleusercontent.com\",\n    render: renderProps => /*#__PURE__*/React.createElement(Button, {\n      className: classes.googleButton,\n      color: \"primary\",\n      fullWidth: true,\n      onClick: renderProps.onClick,\n      disabled: renderProps.disabled,\n      startIcon: /*#__PURE__*/React.createElement(Icon, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 22\n        }\n      }),\n      variant: \"contained\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 11\n      }\n    }, \"Google Sign In\"),\n    onSuccess: googleSuccess,\n    onFailure: googleError,\n    cookiePolicy: \"single_host_origin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 9\n    }\n  });\n};\n\nexport default Google_log;","map":{"version":3,"names":["React","useEffect","GoogleLogin","Button","Icon","gapi","useDispatch","useNavigate","useStyles","AUTH","Google_log","classes","dispatch","navigate","start","client","init","clientId","scope","load","googleSuccess","res","console","log","result","profileObj","token","tokenId","type","data","error","googleError","renderProps","googleButton","onClick","disabled"],"sources":["E:/Learn/FullStack/client/src/components/Auth/Google_log.js"],"sourcesContent":["\r\n\r\n  import React,{useEffect} from 'react'\r\n  import {GoogleLogin} from 'react-google-login'\r\n  import {Button, Icon} from '@material-ui/core'\r\n  import { gapi } from 'gapi-script'\r\n  import {useDispatch} from 'react-redux'\r\n\r\n  //import { useHistory } from 'react-router-dom';\r\n  //replaced by useNavigate\r\n  import { useNavigate } from 'react-router-dom'\r\n  import useStyles from './styles'\r\nimport { AUTH } from '../../constants/actionTypes'\r\n\r\n  const Google_log = () => {\r\n    const classes = useStyles()\r\n\r\n    //dispatch reducers\r\n    const  dispatch=useDispatch()\r\n\r\n    const navigate=useNavigate()\r\n\r\n    useEffect(() => {\r\n        function start() {\r\n          gapi.client.init({\r\n            clientId: \"20521068448-qc63tjr0ub065rv0knnl9gr1818744t4.apps.googleusercontent.com\",\r\n            scope: 'email',\r\n          });\r\n        }\r\n    \r\n        gapi.load('client:auth2', start);\r\n      }, []);\r\n\r\n    const googleSuccess= async (res) =>{\r\n        console.log(\"成功\"+res)\r\n        const result=res?.profileObj\r\n      //创建token\r\n      const token= res?.tokenId;\r\n\r\n      try {\r\n        dispatch({type:AUTH,data:{result,token}})\r\n        \r\n        //自动刷新\r\n        navigate('/')\r\n      } catch (error) {\r\n        console.log(error)\r\n      }\r\n      }\r\n      const googleError = (error) =>{\r\n        console.log('google登录失败啦,error信息：')\r\n        console.log(error)\r\n      }\r\n    return (\r\n        <GoogleLogin\r\n        clientId=\"20521068448-qc63tjr0ub065rv0knnl9gr1818744t4.apps.googleusercontent.com\"\r\n        render={(renderProps)=>(\r\n          <Button \r\n          className={classes.googleButton} \r\n          color='primary' fullWidth \r\n          onClick={renderProps.onClick} \r\n          disabled={renderProps.disabled} \r\n          startIcon={<Icon/>} \r\n          variant=\"contained\">\r\n            Google Sign In\r\n          </Button>\r\n        )}\r\n        onSuccess={googleSuccess}\r\n        onFailure={googleError}\r\n        cookiePolicy=\"single_host_origin\"\r\n    />\r\n    )\r\n  }\r\n  \r\n  export default Google_log"],"mappings":";AAEE,OAAOA,KAAP,IAAcC,SAAd,QAA8B,OAA9B;AACA,SAAQC,WAAR,QAA0B,oBAA1B;AACA,SAAQC,MAAR,EAAgBC,IAAhB,QAA2B,mBAA3B;AACA,SAASC,IAAT,QAAqB,aAArB;AACA,SAAQC,WAAR,QAA0B,aAA1B,C,CAEA;AACA;;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,OAAOC,SAAP,MAAsB,UAAtB;AACF,SAASC,IAAT,QAAqB,6BAArB;;AAEE,MAAMC,UAAU,GAAG,MAAM;EACvB,MAAMC,OAAO,GAAGH,SAAS,EAAzB,CADuB,CAGvB;;EACA,MAAOI,QAAQ,GAACN,WAAW,EAA3B;EAEA,MAAMO,QAAQ,GAACN,WAAW,EAA1B;EAEAN,SAAS,CAAC,MAAM;IACZ,SAASa,KAAT,GAAiB;MACfT,IAAI,CAACU,MAAL,CAAYC,IAAZ,CAAiB;QACfC,QAAQ,EAAE,yEADK;QAEfC,KAAK,EAAE;MAFQ,CAAjB;IAID;;IAEDb,IAAI,CAACc,IAAL,CAAU,cAAV,EAA0BL,KAA1B;EACD,CATM,EASJ,EATI,CAAT;;EAWA,MAAMM,aAAa,GAAE,MAAOC,GAAP,IAAc;IAC/BC,OAAO,CAACC,GAAR,CAAY,OAAKF,GAAjB;IACA,MAAMG,MAAM,GAACH,GAAD,aAACA,GAAD,uBAACA,GAAG,CAAEI,UAAlB,CAF+B,CAGjC;;IACA,MAAMC,KAAK,GAAEL,GAAF,aAAEA,GAAF,uBAAEA,GAAG,CAAEM,OAAlB;;IAEA,IAAI;MACFf,QAAQ,CAAC;QAACgB,IAAI,EAACnB,IAAN;QAAWoB,IAAI,EAAC;UAACL,MAAD;UAAQE;QAAR;MAAhB,CAAD,CAAR,CADE,CAGF;;MACAb,QAAQ,CAAC,GAAD,CAAR;IACD,CALD,CAKE,OAAOiB,KAAP,EAAc;MACdR,OAAO,CAACC,GAAR,CAAYO,KAAZ;IACD;EACA,CAdH;;EAeE,MAAMC,WAAW,GAAID,KAAD,IAAU;IAC5BR,OAAO,CAACC,GAAR,CAAY,sBAAZ;IACAD,OAAO,CAACC,GAAR,CAAYO,KAAZ;EACD,CAHD;;EAIF,oBACI,oBAAC,WAAD;IACA,QAAQ,EAAC,yEADT;IAEA,MAAM,EAAGE,WAAD,iBACN,oBAAC,MAAD;MACA,SAAS,EAAErB,OAAO,CAACsB,YADnB;MAEA,KAAK,EAAC,SAFN;MAEgB,SAAS,MAFzB;MAGA,OAAO,EAAED,WAAW,CAACE,OAHrB;MAIA,QAAQ,EAAEF,WAAW,CAACG,QAJtB;MAKA,SAAS,eAAE,oBAAC,IAAD;QAAA;QAAA;UAAA;UAAA;UAAA;QAAA;MAAA,EALX;MAMA,OAAO,EAAC,WANR;MAAA;MAAA;QAAA;QAAA;QAAA;MAAA;IAAA,oBAHF;IAaA,SAAS,EAAEf,aAbX;IAcA,SAAS,EAAEW,WAdX;IAeA,YAAY,EAAC,oBAfb;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,EADJ;AAmBD,CAzDD;;AA2DA,eAAerB,UAAf"},"metadata":{},"sourceType":"module"}